        lib     mdevtab.h        sttl    Device Driver Tables        pag        name    devtab        data* important to export these GLOBAL symbols        define** Interrupt Handler Table*    Used to decide which device generated an interrupt* and how to process it.*inttab        fcb     N_intdev        number of interrupt devices* tty 0        fcb     0,0             ACIA        fcb     %10000000       int mask        fdb     BASACI+$00      status register        fdb     0,0             No Baud Rate Generators        fdb     tintr           tty interrupt routine        fdb     0               device number* tty 1        fcb     0,7             ACIA        fcb     %10000000       int mask        fdb     BASACI+$10      status register        fdb     $000f,tbrbu1    low nibble, backup byte 1        fdb     tintr           tty interrupt routine        fdb     1               device number* tty 2        fcb     0,5             ACIA        fcb     %10000000       int mask        fdb     BASACI+$14      status register        fdb     $00f0,tbrbu1        fdb     tintr           tty interrupt routine        fdb     2               device number* tty 3        fcb     0,5             ACIA        fcb     %10000000       int mask        fdb     BASACI+$18      status register        fdb     $000f,tbrbu2        fdb     tintr           tty interrupt routine        fdb     3               device number* tty 4        fcb     0,7             ACIA        fcb     %10000000       int mask        fdb     BASACI+$1C      status register        fdb     $00f0,tbrbu2        fdb     tintr           tty interrupt routine        fdb     4               device number**N_intdev equ    (*-inttab-1)/INTSIZ*        ifc     &a,'IOP'        if      (N_intdev>=IOPTDMIN)        err     "tty table conflict with IOP, check mdevtab.t"        endif        endifintend  equ     *** fnttab** Interrupt table for firq type interrupts.  It is* the same as inttab above.*fnttabfntend  equ     * pag** Device tables** Character tablechrtab* tty device  [0]LCLTTY  equ     (*-chrtab)/DEVSIZ        fdb     ttopn           tty open routine        fdb     ttcls           tty close routine        fdb     ttrd            tty read routine        fdb     ttwr            tty write routine        fdb     ttspc           special routine* mem device  [1]        fdb     nuldev          mem open        fdb     nuldev          mem close        fdb     mdrd            mem read        fdb     mdwr            mem write        fdb     nuldev          mem special* null device [2]        fdb     nuldev          null dev open        fdb     nuldev          null dev close        fdb     nuldrd          null device read        fdb     nuldwr          null device write        fdb     nuldev          null special* ide character drivers  [3]        fdb     ideop           ide open        fdb     idecl           ide close        fdb     iderd           ide read        fdb     idewr           ide write        fdb     idesp           special* acia speed setting driver [4]        fdb     tspdopn         open (exclusive)        fdb     tspdcls         close        fdb     nuldev          read (void)        fdb     nuldev          write (void)        fdb     tspdspcl        special (real action)*IOPTTY  equ     (*-chrtab)/DEVSIZ       ifc  &a,'IOP'* iop serial port        fdb     iop_open        fdb     iop_close        fdb     iop_read        fdb     iop_write        fdb     iop_spcl        endif*CHRDEV  equ     (*-chrtab)/DEVSIZ* Block device tableblktab        fdb     BDopen,IDEopen          open routine        fdb     BDclose,IDEclose        close routine        fdb     BDio,IDEio              main io routine        fdb     idedt                  device table pointer        fcb     IDEmaxBLKDEV  equ     (*-blktab)/BLKSIZ* Block Device 0 Open tableIDEopenIDEminor equ  (*-IDEopen)/2IDEmajor equ 0        fdb     ideopen                 hd0        fdb     ideopen                 hd1        fdb     ideopen        fdb     ideopen        fdb     ideopen        fdb     ideopen        fdb     ideopen        fdb     ideopenIDEmax  equ     (*-IDEopen)/2* Block Device 0 Close TableIDEclose        fdb     ideclose                hd0        fdb     ideclose                hd1        fdb     ideclose        fdb     ideclose        fdb     ideclose        fdb     ideclose        fdb     ideclose        fdb     ideclose* Block Device 0 I/O TableIDEio        fdb     ideio                   hd0        fdb     ideio                   hd1        fdb    ideio        fdb    ideio        fdb    ideio        fdb    ideio        fdb    ideio        fdb    ideio*** IOP data structures*        ifc     &a,'IOP'*IOP0      rzb   2       iop_mbx lock   Task id of locker          rzb   2       iop_fifo lock  Task id of locker          rzb   1       iop_int Set non-zero if message interrupt was missed          rzb   1       iop_tflg Waiting on transaction slot semaphore          fdb   IOP0BASE          rzb   MAX_TRAN*TRAN_SIZE        endif ifc &b,'ROMDEBUG'** ROM routines*Pdata lda ,x+ get next character beq 99f exit at null bsr Pchar print it bra Pdata continue99 rtsPhex pshs cc seti jsr [$F80C] puls cc,pcPspace pshs a lda #$20  space char bsr Pchar puls a,pcPchar pshs cc seti jsr [$F808] puls cc,pcTinit pshs cc seti jsr [$F802] puls cc,pcPhex2 pshs b bsr Phex puls a bra Phex        endif  enddef  end