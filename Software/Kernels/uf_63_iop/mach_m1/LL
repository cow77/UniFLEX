                     *                     * driver to set/get terminal speed settings                     *                               opt    lis                       0000                         data                               name   tspddrvr                               global tspdopn,tspdcls,tspdrd,tspdwr,tspdspcl                                            0000 FFFF          tspd_dev  fdb    $ffff     device code  0002 0000          tspd_dptr fdb    0         inttab pointer  0004 00            tspd_flg  fcb    0                                          *                     * drivers hould be used exclusieve, i.e. single access                     *                                          + 0005 7D   0004     tspdopn   tst    tspd_flg  0008 26   07                 bne    01f+ 000A 7C   0004               inc    tspd_flg  000D 17   00AE               lbsr   tspd_ini  init driver vars  0010 39                      rts                       0011 86   10       01        lda    #EBSYX 0013 B7   0000               sta    uerror  0016 39                      rts                                          *+ 0017 7D   0004     tspdcls   tst    tspd_flg  001A 27   04                 beq    01f+ 001C 7F   0004               clr    tspd_flg  001F 39                      rts                       0020 86   0A       01        lda    #EPRMX 0022 B7   0000               sta    uerror  0025 39                      rts                                          *+              0026  tspdrd    equ    *+              0026  tspdwr    equ    *  0026 CC   0000               ldd    #0X 0029 FD   0001               std    urglst+UD  002C 86   0C                 lda    #EBARGX 002E B7   0000               sta    uerror  0031 39                      rts                                          *                     * on ntry D= device maj/min, X=0flags, Y=chrtab entry                     *+              0032  tspdspcl  equ    *  0032 1F   12                 tfr    x,y       save flag  0034 108C 0000               cmpy   #0  0038 26   4C                 bne    tspd_set                     *  get data from usargx, do SET here+ 003A BE   0000               ldx    tspd_devUniFLEX    Operating System (C)1     11:58:41  Nov 28, 2019   Page    1Macro Definitions                                     003D 8C   FFFF               cmpx   #$ffff  0040 26   08                 bne    01f >0042 17   0056               lbsr   tspdfdev  find device entry+ 0045 BF   0002               stx    tspd_dptr  0048 27   36                 beq    tspd_er1  not found                     *+ 004A BE   0002     01        ldx    tspd_dptr get pointer to device info  004D 27   31                 beq    tspd_er1                     *X 004F FC   0000               ldd    usarg0    check if we did wellX 0052 10A3 89 0000            cmpd   indev,x  0057 26   27                 bne    tspd_er1X 0059 10AE 89 0000            ldy    inbrbu,x  get pointer to data byteX 005E F6   0001               ldb    usarg1+1  fetch low byte  0061 C4   0F                 andb   #$0fX 0063 A6   89 0000            lda    inbrmsk,x  0067 43                      coma             invert mask  0068 A4   A4                 anda   0,y  006A 34   02                 pshs   a  006C 81   0F                 cmpa   #$0f  006E 27   04                 beq    01f  0070 58                      lslb  0071 58                      lslb  0072 58                      lslb  0073 58                      lslb  0074 EA   E0       01        orab   0,s+  0076 E7   A4                 stb    0,y                     * update default for deviceX 0078 F6   0001               ldb    usarg1+1X 007B E7   89 0000            stb    inspcl,x  007F 39                      rts                     *+              0080  tspd_er1  equ    *  0080 86   12                 lda    #EBDEVX 0082 B7   0000               sta    uerror  0085 39                      rts                                                               * put data to Y, do get here+              0086  tspd_set  equ    *+ 0086 BE   0002               ldx    tspd_dptr  0089 AF   A1                 stx    0,y++  008B 27   09                 beq    01fX 008D AE   89 0000            ldx    inbrbu,x  0091 4F                      clra  0092 E6   84                 ldab   0,x  0094 20   02                 bra    10f  0096 1F   10       01        tfr    x,d                     *  0098 ED   A1       10        std    0,y++  009A 39                      rts                     UniFLEX    Operating System (C)1     11:58:41  Nov 28, 2019   Page    2Macro Definitions                                                        *                     * locate device info in inttab,                     * D contains maj/min of device                     * on return X point to entry                     * 0 if not found                     *+              009B  tspdfdev  equ    *  009B 34   06                 pshs   dX 009D 8E   0000               ldx    #inttab  00A0 E6   80                 ldb    0,x+      # of entries  00A2 34   04                 pshs   b  00A4 27   11                 beq    15f       none?                     *  00A6 EC   61       05        ldd    1,sX 00A8 10A3 89 0000            cmpd   indev,x   check it  00AD 27   0B                 beq    10fX 00AF 30   89 0000            leax   INTSIZ,x  next netry  00B3 6A   E4                 dec    0,s  00B5 26   EF                 bne    05b  00B7 8E   0000     15        ldx    #0        not found  00BA 32   61       10        leas   1,s       purge counter  00BC 35   86                 puls   d,pc                     *                     *                     *+              00BE  tspd_ini  equ    *  00BE CC   FFFF               ldd    #$ffff+ 00C1 FD   0000               std    tspd_dev  set device invalid  00C4 CC   0000               ldd    #0X 00C7 FD   0000               std    tspd_iptr  00CA 39                      rts                                                    endUniFLEX    Operating System (C)1     11:58:41  Nov 28, 2019   Page    3Macro Definitions                                   Symbol Table:Absolute Symbols:ALARMS   000A   BARGS    0007   BFALOC   0001   BFERR    0004   BFIOF    0002   BFLAT    0040   BFNOW    0020   BFREQ    0008   BFRWF    0010   BFSPC    0080   BSPCH    007F   BUFPR    0032   BUFSIZ   0200   CBIT     0001   CBSIZE   0020   CDBLKS   0064   CFDN     0032   CNCLC    0018   CR       000D   DIRSIZ   000E   DPLCNT   000A   DPLSIZ   0009   DRVPAG   0009   DSKADS   0003   DVTSIZ   000C   EARGC    0013   EBADF    0007   EBARG    000C   EBBIG    0016   EBDCL    001A   EBDEV    0012   EBIT     0080   EBSY     0010   EDFUL    0005   EDTOF    0003   EFAULT   0002   EFLX     000B   EINTR    001B   EIO      0001   EISDR    0014   ELOCK    001F   EMSDR    0009   EMT2S    0008   EMTS     0004   ENBLK    000F   ENCHD    0018   ENDR     0004   ENMNT    0011   ENOFL    0008   ENOTB    0015   ENTSK    001C   ENTTY    001D   EOTCH    0004   EPIPE    001E   EPRM     000A   ESEEK    000D   ESTOF    0017   ETMFL    0006   ETMTS    0019   EXCSIZ   0008   EXDEV    000E   F        0040   FALTS    0007   FDNPR    0064   HANGS    0001   HDRSIZ   0018   HOLDC    001B   I        0010   INTRC    0003   INTS     0002   KILLS    0005   MAPSIZ   000D   MAXPAG   0100   MAXPAGES 0010   MAXPIP   1000   NFDNPR   0050   NL       000A   NODEV    FFFF   PAGSIZ   1000   PIPEPR   FFFB   PRCSIZ   0100   QUITC    001C   QUITS    0003   REGSIZ   0008   RESTM    0009   SBUF     000C   SBUFFR   C000   SIGCNT   000C   SLEPPR   FFB0   SMAPSZ   0100   SPACE    0020   STABPG   0001   STKOFS   0F3E   SWAPPR   0078   SYSBLK   000F   SYSLOC   0000   SYSPAG   0000   SYSSTK   BF3E   SYSTXT   0005   TABCH    0009   TIMES    0009   TRACS    0008   TTYIPR   FFF6   TTYOPR   FFEC   UA       0001   UB       0002   UCC      0000   UD       0001   UNFILS   0010   UPB      0007   UPC      0005   USERBL   BF3E   USERPR   FFA6   USRLOC   000B   USTKO    0E00   UX       0003   WAITPR   FFD8   WBUFPR   001E   WMEMPR   FFFB   WPIPES   0006   XBUF     000D   XBUFFR   D000   XOFFC    0013   XONC     0011   bfadr    0010   bfblch   000C   bfblck   000D   bfdbl    0002   bfdfl    0000   bfdvn    000A   bffbl    0006   bfffl    0004   bfflag   0008   bfflg2   0009   bfspr    0015   bfstat   0014   bfxadr   000F   bfxfc    0012   dtbusy   0008   dtdbl    0002   dtdfl    0000   dtqbl    0006   dtqfl    0004   dtrtry   0009   dtspr    000A   Text Segment Symbols:     NoneData Segment Symbols:tspd_dev 0000   tspd_dpt 0002   tspd_er1 0080   tspd_flg 0004   tspd_ini 00BE   tspd_set 0086   tspdcls  0017   tspdfdev 009B   tspdopn  0005   tspdrd   0026   tspdspcl 0032   tspdwr   0026   Bss Segment Symbols:     NoneUniFLEX    Operating System (C)1     11:58:42  Nov 28, 2019   Page    4Macro Definitions                                   External Symbols:INTSIZ   0000   inbrbu   0000   inbrmsk  0000   indev    0000   inspcl   0000   inttab   0000   tspd_ipt 0000   uerror   0000   urglst   0000   usarg0   0000   usarg1   0000   